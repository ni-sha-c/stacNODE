time_step: 0.01
lr: 0.001
weight_decay: 0.0005
num_epoch: 10000
num_train: 10000
num_test: 8000
num_val: 3000
num_trans: 0
loss_type: Jacobian
dyn_sys: baker
model_type: MLP
s: 0.8
n_hidden: 512
n_layers: 3
reg_param: 500
threshold: 0.0
optim_name: AdamW
Epoch: 0 Train: 127224.304687500 Test: 69136.265625000
Epoch 0: New minimal relative error: 69136.27%, model saved.
Epoch: 100 Train: 5716.140136719 Test: 4833.466796875
Epoch 100: New minimal relative error: 4833.47%, model saved.
Epoch: 200 Train: 4268.791015625 Test: 3479.699707031
Epoch 200: New minimal relative error: 3479.70%, model saved.
Epoch: 300 Train: 4010.387695312 Test: 3221.649902344
Epoch 300: New minimal relative error: 3221.65%, model saved.
Epoch: 400 Train: 3800.234619141 Test: 3004.010009766
Epoch 400: New minimal relative error: 3004.01%, model saved.
Epoch: 500 Train: 3575.763427734 Test: 2993.434082031
Epoch 500: New minimal relative error: 2993.43%, model saved.
Epoch: 600 Train: 3270.481445312 Test: 2392.127197266
Epoch 600: New minimal relative error: 2392.13%, model saved.
Epoch: 700 Train: 2952.717041016 Test: 2089.188720703
Epoch 700: New minimal relative error: 2089.19%, model saved.
Epoch: 800 Train: 2808.964843750 Test: 1896.541137695
Epoch 800: New minimal relative error: 1896.54%, model saved.
Epoch: 900 Train: 2714.109863281 Test: 1798.845703125
Epoch 900: New minimal relative error: 1798.85%, model saved.
Epoch: 1000 Train: 3439.556152344 Test: 2579.392089844
Epoch: 1100 Train: 2516.881835938 Test: 1577.387207031
Epoch 1100: New minimal relative error: 1577.39%, model saved.
Epoch: 1200 Train: 2494.055419922 Test: 1523.002075195
Epoch 1200: New minimal relative error: 1523.00%, model saved.
Epoch: 1300 Train: 2421.940673828 Test: 1454.720458984
Epoch 1300: New minimal relative error: 1454.72%, model saved.
Epoch: 1400 Train: 2391.916992188 Test: 1414.524291992
Epoch 1400: New minimal relative error: 1414.52%, model saved.
Epoch: 1500 Train: 2370.696777344 Test: 1386.423461914
Epoch 1500: New minimal relative error: 1386.42%, model saved.
Epoch: 1600 Train: 2369.010498047 Test: 1378.341186523
Epoch 1600: New minimal relative error: 1378.34%, model saved.
Epoch: 1700 Train: 2345.798339844 Test: 1359.839233398
Epoch 1700: New minimal relative error: 1359.84%, model saved.
Epoch: 1800 Train: 2333.451660156 Test: 1347.596923828
Epoch 1800: New minimal relative error: 1347.60%, model saved.
Epoch: 1900 Train: 2549.353759766 Test: 1438.940917969
Epoch: 2000 Train: 2316.814453125 Test: 1334.934326172
Epoch 2000: New minimal relative error: 1334.93%, model saved.
Epoch: 2100 Train: 2307.398925781 Test: 1326.620239258
Epoch 2100: New minimal relative error: 1326.62%, model saved.
Epoch: 2200 Train: 2420.750488281 Test: 1572.609985352
Epoch: 2300 Train: 2293.183593750 Test: 1317.522216797
Epoch 2300: New minimal relative error: 1317.52%, model saved.
Epoch: 2400 Train: 2285.017333984 Test: 1310.873657227
Epoch 2400: New minimal relative error: 1310.87%, model saved.
Epoch: 2500 Train: 2277.337402344 Test: 1305.042358398
Epoch 2500: New minimal relative error: 1305.04%, model saved.
Epoch: 2600 Train: 2271.910888672 Test: 1302.667968750
Epoch 2600: New minimal relative error: 1302.67%, model saved.
Epoch: 2700 Train: 2264.487304688 Test: 1296.275756836
Epoch 2700: New minimal relative error: 1296.28%, model saved.
Epoch: 2800 Train: 2259.911865234 Test: 1296.878173828
Epoch: 2900 Train: 2252.674316406 Test: 1287.508911133
Epoch 2900: New minimal relative error: 1287.51%, model saved.
Epoch: 3000 Train: 2245.952148438 Test: 1281.760009766
Epoch 3000: New minimal relative error: 1281.76%, model saved.
Epoch: 3100 Train: 2241.395996094 Test: 1279.375854492
Epoch 3100: New minimal relative error: 1279.38%, model saved.
Epoch: 3200 Train: 2234.691894531 Test: 1273.122314453
Epoch 3200: New minimal relative error: 1273.12%, model saved.
Epoch: 3300 Train: 2231.283935547 Test: 1271.177246094
Epoch 3300: New minimal relative error: 1271.18%, model saved.
Epoch: 3400 Train: 2223.436767578 Test: 1265.351928711
Epoch 3400: New minimal relative error: 1265.35%, model saved.
Epoch: 3500 Train: 2217.036376953 Test: 1260.709350586
Epoch 3500: New minimal relative error: 1260.71%, model saved.
Epoch: 3600 Train: 2212.638671875 Test: 1258.515136719
Epoch 3600: New minimal relative error: 1258.52%, model saved.
Epoch: 3700 Train: 2206.443359375 Test: 1254.018676758
Epoch 3700: New minimal relative error: 1254.02%, model saved.
Epoch: 3800 Train: 2202.540039062 Test: 1252.721069336
Epoch 3800: New minimal relative error: 1252.72%, model saved.
Epoch: 3900 Train: 2195.915527344 Test: 1247.772216797
Epoch 3900: New minimal relative error: 1247.77%, model saved.
Epoch: 4000 Train: 2191.940917969 Test: 1247.666381836
Epoch 4000: New minimal relative error: 1247.67%, model saved.
Epoch: 4100 Train: 2185.834472656 Test: 1242.732421875
Epoch 4100: New minimal relative error: 1242.73%, model saved.
Epoch: 4200 Train: 2180.189453125 Test: 1238.947265625
Epoch 4200: New minimal relative error: 1238.95%, model saved.
Epoch: 4300 Train: 2180.369140625 Test: 1246.165893555
Epoch: 4400 Train: 2170.471191406 Test: 1234.022583008
Epoch 4400: New minimal relative error: 1234.02%, model saved.
Epoch: 4500 Train: 2164.906738281 Test: 1230.949218750
Epoch 4500: New minimal relative error: 1230.95%, model saved.
Epoch: 4600 Train: 2160.544189453 Test: 1228.899902344
Epoch 4600: New minimal relative error: 1228.90%, model saved.
Epoch: 4700 Train: 2155.200927734 Test: 1226.261596680
Epoch 4700: New minimal relative error: 1226.26%, model saved.
Epoch: 4800 Train: 2151.189697266 Test: 1224.325439453
Epoch 4800: New minimal relative error: 1224.33%, model saved.
Epoch: 4900 Train: 2145.871826172 Test: 1221.816284180
Epoch 4900: New minimal relative error: 1221.82%, model saved.
Epoch: 5000 Train: 2178.404785156 Test: 1230.954467773
Epoch: 5100 Train: 2136.713378906 Test: 1217.317138672
Epoch 5100: New minimal relative error: 1217.32%, model saved.
Epoch: 5200 Train: 2141.078613281 Test: 1236.910766602
Epoch: 5300 Train: 2127.613037109 Test: 1212.667846680
Epoch 5300: New minimal relative error: 1212.67%, model saved.
Epoch: 5400 Train: 2122.677978516 Test: 1209.902465820
Epoch 5400: New minimal relative error: 1209.90%, model saved.
Epoch: 5500 Train: 2118.692626953 Test: 1208.332519531
Epoch 5500: New minimal relative error: 1208.33%, model saved.
Epoch: 5600 Train: 2113.888671875 Test: 1205.361694336
Epoch 5600: New minimal relative error: 1205.36%, model saved.
Epoch: 5700 Train: 2110.379150391 Test: 1199.828735352
Epoch 5700: New minimal relative error: 1199.83%, model saved.
Epoch: 5800 Train: 2105.246093750 Test: 1200.566162109
Epoch: 5900 Train: 2103.396484375 Test: 1197.954467773
Epoch 5900: New minimal relative error: 1197.95%, model saved.
Epoch: 6000 Train: 2096.767822266 Test: 1195.874755859
Epoch 6000: New minimal relative error: 1195.87%, model saved.
Epoch: 6100 Train: 2092.137207031 Test: 1193.173706055
Epoch 6100: New minimal relative error: 1193.17%, model saved.
Epoch: 6200 Train: 2088.274902344 Test: 1191.012939453
Epoch 6200: New minimal relative error: 1191.01%, model saved.
Epoch: 6300 Train: 2083.590820312 Test: 1188.940307617
Epoch 6300: New minimal relative error: 1188.94%, model saved.
Epoch: 6400 Train: 2084.285644531 Test: 1187.105590820
Epoch 6400: New minimal relative error: 1187.11%, model saved.
Epoch: 6500 Train: 2075.072265625 Test: 1184.289184570
Epoch 6500: New minimal relative error: 1184.29%, model saved.
Epoch: 6600 Train: 2090.222412109 Test: 1186.099365234
Epoch: 6700 Train: 2067.012695312 Test: 1179.678344727
Epoch 6700: New minimal relative error: 1179.68%, model saved.
Epoch: 6800 Train: 2062.807128906 Test: 1177.231323242
Epoch 6800: New minimal relative error: 1177.23%, model saved.
Epoch: 6900 Train: 2059.353759766 Test: 1176.952392578
Epoch 6900: New minimal relative error: 1176.95%, model saved.
Epoch: 7000 Train: 2055.135253906 Test: 1172.871582031
Epoch 7000: New minimal relative error: 1172.87%, model saved.
Epoch: 7100 Train: 2051.715820312 Test: 1171.552490234
Epoch 7100: New minimal relative error: 1171.55%, model saved.
Epoch: 7200 Train: 2047.696533203 Test: 1168.460815430
Epoch 7200: New minimal relative error: 1168.46%, model saved.
Epoch: 7300 Train: 2136.423828125 Test: 1268.084838867
Epoch: 7400 Train: 2040.620239258 Test: 1164.242797852
Epoch 7400: New minimal relative error: 1164.24%, model saved.
Epoch: 7500 Train: 2037.036376953 Test: 1162.006835938
Epoch 7500: New minimal relative error: 1162.01%, model saved.
Epoch: 7600 Train: 2033.727294922 Test: 1161.765014648
Epoch 7600: New minimal relative error: 1161.77%, model saved.
Epoch: 7700 Train: 2030.531982422 Test: 1156.960693359
Epoch 7700: New minimal relative error: 1156.96%, model saved.
Epoch: 7800 Train: 2027.111083984 Test: 1156.015502930
Epoch 7800: New minimal relative error: 1156.02%, model saved.
Epoch: 7900 Train: 2026.088378906 Test: 1156.402832031
Epoch: 8000 Train: 2020.740722656 Test: 1152.043334961
Epoch 8000: New minimal relative error: 1152.04%, model saved.
Epoch: 8100 Train: 2019.014648438 Test: 1153.035522461
Epoch: 8200 Train: 2014.319824219 Test: 1148.041015625
Epoch 8200: New minimal relative error: 1148.04%, model saved.
Epoch: 8300 Train: 2011.219360352 Test: 1146.031616211
Epoch 8300: New minimal relative error: 1146.03%, model saved.
Epoch: 8400 Train: 2007.931640625 Test: 1143.850585938
Epoch 8400: New minimal relative error: 1143.85%, model saved.
Epoch: 8500 Train: 2004.854858398 Test: 1141.773315430
Epoch 8500: New minimal relative error: 1141.77%, model saved.
Epoch: 8600 Train: 2001.498046875 Test: 1139.782592773
Epoch 8600: New minimal relative error: 1139.78%, model saved.
Epoch: 8700 Train: 1998.327514648 Test: 1135.847290039
Epoch 8700: New minimal relative error: 1135.85%, model saved.
Epoch: 8800 Train: 1998.231201172 Test: 1139.682861328
Epoch: 8900 Train: 1991.703125000 Test: 1133.559326172
Epoch 8900: New minimal relative error: 1133.56%, model saved.
Epoch: 9000 Train: 1988.627197266 Test: 1131.377197266
Epoch 9000: New minimal relative error: 1131.38%, model saved.
Epoch: 9100 Train: 1985.184814453 Test: 1129.466796875
Epoch 9100: New minimal relative error: 1129.47%, model saved.
Epoch: 9200 Train: 1985.311523438 Test: 1137.568847656
Epoch: 9300 Train: 1978.805908203 Test: 1126.273681641
Epoch 9300: New minimal relative error: 1126.27%, model saved.
Epoch: 9400 Train: 1975.472167969 Test: 1123.354003906
Epoch 9400: New minimal relative error: 1123.35%, model saved.
Epoch: 9500 Train: 2025.990356445 Test: 1153.308349609
Epoch: 9600 Train: 1969.072021484 Test: 1118.927490234
Epoch 9600: New minimal relative error: 1118.93%, model saved.
Epoch: 9700 Train: 1965.812377930 Test: 1116.799072266
Epoch 9700: New minimal relative error: 1116.80%, model saved.
Epoch: 9800 Train: 1962.665283203 Test: 1114.981689453
Epoch 9800: New minimal relative error: 1114.98%, model saved.
Epoch: 9900 Train: 1959.615478516 Test: 1113.844604492
Epoch 9900: New minimal relative error: 1113.84%, model saved.
Epoch: 9999 Train: 1956.402343750 Test: 1110.955932617
Epoch 9999: New minimal relative error: 1110.96%, model saved.
Training Loss: tensor(1956.4023)
Test Loss: tensor(1110.9559)
True Mean x: tensor(3.0839, device='cuda:0', grad_fn=<MeanBackward0>)
Learned Mean x: tensor(nan, device='cuda:0', grad_fn=<MeanBackward0>)
True Var x: tensor(3.3413, device='cuda:0', grad_fn=<VarBackward0>)
Learned Var x: tensor(nan, device='cuda:0', grad_fn=<VarBackward0>)
Jacobian term Training Loss: tensor(1.8602)
Jacobian term Test Loss: tensor(3.1685)
Learned LE: [nan nan]
True LE: tensor([ 69.3156, -86.8151], dtype=torch.float64)
